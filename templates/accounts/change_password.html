{% extends 'base.html' %}


{% block content %}

<section class="section-conten padding-y bg">

{% include 'includes/alerts.html' %}
<div class="container">
	<div class="row">
	{% include 'includes/dashboard_sidebar.html' %}
	<main class="col-md-9">
		<article class="card">
		<header class="card-header">
			<strong class="d-inline-block mr-3">Change Your Password</strong>

		</header>
		<div class="card-body">
			<div class="row">
			<div class="col-md-12">
				<!-- <form action="{% url 'change_password' %}" method="POST">
					{% csrf_token %}

					<div class="form-group">
						<label>Current Password</label>
						<input type="password" name="current_password" placeholder="Current Password" class="form-control" required>
					</div>
					<div class="form-group">
						<label>Create new password</label>
						<input type="password" name="new_password" placeholder="Create New Password" class="form-control" required>
					</div>
					<div class="form-group">
						<label>Confirm new password</label>
						<input type="password" name="confirm_password" placeholder="Confirm New Password" class="form-control" required>
					</div>

					<input type="submit" value="Submit" class="btn btn-primary">
				</form> -->
				<form action="{% url 'change_password' %}" method="POST" id="changePasswordForm">
					{% csrf_token %}
				
					<div class="form-group">
						<label>Current Password</label>
						<input type="password" name="current_password" placeholder="Current Password" class="form-control" id="current_password" >
						<div id="current_password_error" class="error-message"></div>
					</div>
				
					<div class="form-group">
						<label>Create New Password</label>
						<input type="password" name="new_password" placeholder="Create New Password" class="form-control" id="new_password" >
						<div id="new_password_error" class="error-message"></div>
					</div>
				
					<div class="form-group">
						<label>Confirm New Password</label>
						<input type="password" name="confirm_password" placeholder="Confirm New Password" class="form-control" id="confirm_password" >
						<div id="confirm_password_error" class="error-message"></div>
					</div>
				
					<input type="submit" value="Submit" class="btn btn-primary">
				</form>
				
				<!-- Include this script for front-end validation -->
				<script>
					document.addEventListener('DOMContentLoaded', function() {
						const form = document.getElementById('changePasswordForm');
					
						form.addEventListener('submit', function(event) {
							let isValid = true;
							
							// Regular expression for password validation: at least 8 characters, one uppercase, one lowercase, one number, one special character
							const passwordPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
					
							// Validate Current Password
							const currentPassword = document.getElementById('current_password');
							const currentPasswordError = document.getElementById('current_password_error');
							if (!passwordPattern.test(currentPassword.value)) {
								currentPasswordError.textContent = 'Current password must be at least 8 characters long, and include one uppercase letter, one lowercase letter, one number, and one special character.';
								isValid = false;
							} else {
								currentPasswordError.textContent = '';
							}
					
							// Validate New Password
							const newPassword = document.getElementById('new_password');
							const newPasswordError = document.getElementById('new_password_error');
							if (!passwordPattern.test(newPassword.value)) {
								newPasswordError.textContent = 'New password must be at least 8 characters long, and include one uppercase letter, one lowercase letter, one number, and one special character.';
								isValid = false;
							} else {
								newPasswordError.textContent = '';
							}
					
							// Validate Confirm Password (to ensure both passwords match)
							const confirmPassword = document.getElementById('confirm_password');
							const confirmPasswordError = document.getElementById('confirm_password_error');
							if (confirmPassword.value !== newPassword.value) {
								confirmPasswordError.textContent = 'Passwords do not match.';
								isValid = false;
							} else {
								confirmPasswordError.textContent = '';
							}
					
							// Prevent form submission if validation fails
							if (!isValid) {
								event.preventDefault();
							}
						});
					});
				</script>
				
				
				
				<!-- Include this CSS for error message styling -->
				<style>
					.error-message {
						color: red;
						font-size: 0.875em; /* Optional: smaller font size for error messages */
						margin-top: 0.25em; /* Space between the input and the error message */
					}
				</style>
				
			</div>

			</div> <!-- row.// -->
		</div> <!-- card-body .// -->

		</article> <!-- order-group.// -->
	</main>
</div> <!-- row.// -->
</div>


</section>

{% endblock %}
